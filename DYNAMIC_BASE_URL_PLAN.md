# ๐ ุฎุทุฉ ุฌุนู ุงูุชุทุจูู ูุนูู ุนูู ุฃู ุฏูููู ุฌุฏูุฏ

## ๐ฏ ุงููุฏู
ุฌุนู ุงูุชุทุจูู ูุนูู ุชููุงุฆูุงู ุนูู ุฃู ุฏูููู ุฌุฏูุฏ ุจุฏูู ุชุนุฏูู ุงูููุฏ ุฃู ุฅุนุงุฏุฉ ุจูุงุก ุงูุชุทุจูู.

---

## ๐ ุงููุถุน ุงูุญุงูู

### ุงููุดููุฉ:
```dart
// lib/core/api/api_endpoints.dart
static const String baseUrl = 
    'https://fcf0121e-0593-4710-ad11-105d54ba692e-00-3cyb0wsnu78xa.janeway.replit.dev';
```
- โ Base URL ุซุงุจุช ูู ุงูููุฏ
- โ ูุญุชุงุฌ ุชุนุฏูู ุงูููุฏ ุนูุฏ ุชุบููุฑ ุงูุฎุงุฏู
- โ ูุญุชุงุฌ ุฅุนุงุฏุฉ ุจูุงุก ุงูุชุทุจูู

---

## ๐ก ุงูุญููู ุงูููุชุฑุญุฉ

### ุงูุญู 1: Remote Configuration Server (ุงูุฃูุถู) โญ

#### ุงูููููู:
ุฎุงุฏู ุฅุนุฏุงุฏุงุช ูุฑูุฒู ูุญุชูู ุนูู Base URL ุงูุญุงูู.

#### ุงููููุฒุงุช:
- โ ูุง ูุญุชุงุฌ ุชุนุฏูู ุงูููุฏ
- โ ุชุญุฏูุซ ููุฑู ูุฌููุน ุงููุณุชุฎุฏููู
- โ ูููู ุฅุฏุงุฑุฉ ุนุฏุฉ ุจูุฆุงุช (dev, staging, production)
- โ ูููู ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช ุฃุฎุฑู (API version, features flags)

#### ุงูุชุฏูู:
```
1. ุงูุชุทุจูู ูุจุฏุฃ
   โ
2. ูุญุงูู ุงูุงุชุตุงู ุจุฎุงุฏู ุงูุฅุนุฏุงุฏุงุช ุงูุซุงุจุช
   (ูุซุงู: https://config.yourcompany.com/api/config)
   โ
3. ูุญุตู ุนูู Base URL ุงูุญุงูู
   โ
4. ูุญูุธู ูุญููุงู (SecureStorage)
   โ
5. ูุณุชุฎุฏูู ูุฌููุน API calls
```

#### ุงูุจููุฉ:
```
โโโโโโโโโโโโโโโโโโโ
โ  Config Server  โ โ ุฎุงุฏู ุฅุนุฏุงุฏุงุช ุซุงุจุช
โ  (Static URL)   โ   (ูุง ูุชุบูุฑ ุฃุจุฏุงู)
โโโโโโโโโโโโโโโโโโโ
         โ
         โ Returns: { "baseUrl": "https://new-domain.com" }
         โ
         โ
โโโโโโโโโโโโโโโโโโโ
โ  Flutter App    โ
โ                 โ
โ  1. Get Config  โ
โ  2. Save Locallyโ
โ  3. Use for API โ
โโโโโโโโโโโโโโโโโโโ
```

#### ูุซุงู Response:
```json
{
  "baseUrl": "https://new-server.com",
  "apiVersion": "v1",
  "features": {
    "inventoryRequests": true,
    "stockTransfer": true
  },
  "lastUpdated": "2024-01-15T10:00:00Z"
}

```

#### ุงูุชุฎุฒูู:
- **SecureStorage**: Base URL ุงูุญุงูู
- **Hive**: Cache ููู config (fallback)

#### ุชุญุฏูุซ Config:
- ุนูุฏ ุจุฏุก ุงูุชุทุจูู
- ูู 24 ุณุงุนุฉ (background check)
- ุนูุฏ ูุดู API call (retry with new config)

---

### ุงูุญู 2: Deep Linking / URL Scheme

#### ุงูููููู:
ุชุบููุฑ Base URL ุนุจุฑ deep link ุฃู QR code.

#### ุงููููุฒุงุช:
- โ ุณูู ูููุณุชุฎุฏู
- โ ูููู ุชุญุฏูุซู ุจุณุฑุนุฉ
- โ ูุง ูุญุชุงุฌ ุฎุงุฏู ุฅุนุฏุงุฏุงุช

#### ุงูุชุฏูู:
```
1. ุงููุณุชุฎุฏู ููุณุญ QR Code ุฃู ููุชุญ deep link
   nuolipapp://config?baseUrl=https://new-domain.com
   โ
2. ุงูุชุทุจูู ูุณุชูุจู URL
   โ
3. ูุญูุธ Base URL ูู SecureStorage
   โ
4. ูุนูุฏ ุชููุฆุฉ Dio client
   โ
5. ูุณุชูุฑ ุงูุนูู ุจุงูู Base URL ุงูุฌุฏูุฏ
```

#### ูุซุงู Deep Link:
```
nuolipapp://config?baseUrl=https://new-server.com&token=optional
```

#### ูุซุงู QR Code:
```
{
  "baseUrl": "https://new-server.com",
  "apiVersion": "v1"
}
```

---

### ุงูุญู 3: Environment Variables (Build-time)

#### ุงูููููู:
ุงุณุชุฎุฏุงู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุนูุฏ ุงูุจูุงุก.

#### ุงููููุฒุงุช:
- โ ุขูู (ูุง ูููู ุชุบููุฑู ูู ุงูุชุทุจูู)
- โ ููุงุณุจ ููุจูุฆุงุช ุงููุฎุชููุฉ

#### ุงูุนููุจ:
- โ ูุญุชุงุฌ ุฅุนุงุฏุฉ ุจูุงุก ุงูุชุทุจูู
- โ ูุง ูููู ุชุบููุฑู ุจุนุฏ ุงูุจูุงุก

#### ุงูุงุณุชุฎุฏุงู:
```bash
flutter build apk --dart-define=BASE_URL=https://new-domain.com
```

---

### ุงูุญู 4: Configuration File (Runtime)

#### ุงูููููู:
ููู ุฅุนุฏุงุฏุงุช ูุงุจู ููุชุญุฏูุซ (JSON/YAML).

#### ุงููููุฒุงุช:
- โ ูููู ุชุญุฏูุซู ุจุฏูู ุฅุนุงุฏุฉ ุจูุงุก
- โ ูููู ูุถุนู ุนูู CDN

#### ุงูุชุฏูู:
```
1. ุงูุชุทุจูู ูุชุญูู ูู ููู config
   (ูุซุงู: https://cdn.yourcompany.com/config.json)
   โ
2. ูุญุตู ุนูู Base URL
   โ
3. ูุญูุธู ูุญููุงู
   โ
4. ูุณุชุฎุฏูู
```

#### ูุซุงู config.json:
```json
{
  "baseUrl": "https://new-server.com",
  "endpoints": {
    "auth": "/api/auth",
    "inventory": "/api/inventory"
  }
}
```

---

### ุงูุญู 5: DNS-based Discovery

#### ุงูููููู:
ุงุณุชุฎุฏุงู DNS record ุฎุงุต ูุญุชูู ุนูู Base URL.

#### ุงููููุฒุงุช:
- โ ูุฑูุฒู
- โ ูููู ุชุบููุฑู ุจุณุฑุนุฉ

#### ุงูุชุฏูู:
```
1. ุงูุชุทุจูู ูุจุญุซ ุนู TXT record
   config.nuolipapp.com TXT "baseUrl=https://new-server.com"
   โ
2. ูุญุตู ุนูู Base URL
   โ
3. ูุณุชุฎุฏูู
```

---

### ุงูุญู 6: Manual Input (Settings Page)

#### ุงูููููู:
ุตูุญุฉ ุฅุนุฏุงุฏุงุช ูููุณุชุฎุฏู ูุฅุฏุฎุงู Base URL.

#### ุงููููุฒุงุช:
- โ ูุฑููุฉ ูุงููุฉ
- โ ููุงุณุจ ููุงุฎุชุจุงุฑ

#### ุงูุชุฏูู:
```
1. ุงููุณุชุฎุฏู ููุชุญ Settings
   โ
2. ูุฏุฎู Base URL ุงูุฌุฏูุฏ
   โ
3. ุงูุชุทุจูู ูุญูุธู
   โ
4. ูุนูุฏ ุชููุฆุฉ Dio
   โ
5. ูุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
```

---

## ๐ ุงูุญู ุงูููุตู ุจู: Hybrid Approach

### ุงูุฌูุน ุจูู:
1. **Remote Configuration Server** (ุงูุฃุณุงุณู)
2. **Deep Linking** (ููุทูุงุฑุฆ)
3. **Manual Input** (ููุงุฎุชุจุงุฑ)

### ุงูุชุฏูู ุงููุงูู:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ุจุฏุก ุงูุชุทุจูู                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โ
    โโโโโโโโโโโโโโโโโโโโโโโ
    โ  Check SecureStorage โ
    โ  (Base URL ูุญููุธุ)   โ
    โโโโโโโโโโโโโโโโโโโโโโโ
              โ
        โโโโโโโดโโโโโโ
        โ           โ
      ูุนู          ูุง
        โ           โ
        โ           โ
โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโ
โ Use Saved   โ  โ Fetch from Configโ
โ Base URL    โ  โ Server           โ
โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโ
        โ                 โ
        โ                 โ
        โ         โโโโโโโโโโโโโโโโโ
        โ         โ Save Locally  โ
        โ         โโโโโโโโโโโโโโโโโ
        โ                 โ
        โโโโโโโโโโโฌโโโโโโโโ
                  โ
                  โ
        โโโโโโโโโโโโโโโโโโโ
        โ Initialize Dio   โ
        โ with Base URL    โ
        โโโโโโโโโโโโโโโโโโโ
                  โ
                  โ
        โโโโโโโโโโโโโโโโโโโ
        โ Test Connection โ
        โ (Health Check)   โ
        โโโโโโโโโโโโโโโโโโโ
                  โ
          โโโโโโโโโดโโโโโโโโ
          โ               โ
        ูุฌุญ            ูุดู
          โ               โ
          โ               โ
    โโโโโโโโโโโ    โโโโโโโโโโโโโโโโ
    โ Continueโ    โ Try Fallback โ
    โ         โ    โ or Show Errorโ
    โโโโโโโโโโโ    โโโโโโโโโโโโโโโโ
```

---

## ๐ ุงูุชุตููู ุงูููุชุฑุญ

### 1. Configuration Service

```dart
class ConfigurationService {
  // Config Server URL (ุซุงุจุช - ูุง ูุชุบูุฑ)
  static const String configServerUrl = 
      'https://config.nuolipapp.com/api/config';
  
  // Fallback Base URL (ูู ุญุงูุฉ ูุดู Config Server)
  static const String fallbackBaseUrl = 
      'https://fcf0121e-0593-4710-ad11-105d54ba692e-00-3cyb0wsnu78xa.janeway.replit.dev';
  
  // Cache Duration (24 hours)
  static const Duration cacheDuration = Duration(hours: 24);
}
```

### 2. Storage Keys

```dart
class StorageKeys {
  static const String baseUrl = 'app_base_url';
  static const String configLastUpdated = 'config_last_updated';
  static const String configCache = 'config_cache';
}
```

### 3. Update Strategy

#### ุนูุฏ ุจุฏุก ุงูุชุทุจูู:
1. ูุฑุงุกุฉ Base URL ูู SecureStorage
2. ุฅุฐุง ููุฌูุฏ โ ุงุณุชุฎุฏุงูู
3. ุฅุฐุง ุบูุฑ ููุฌูุฏ ุฃู ููุชูู ุงูุตูุงุญูุฉ โ ุฌูุจ ูู Config Server
4. ุฅุฐุง ูุดู Config Server โ ุงุณุชุฎุฏุงู Fallback

#### ุฃุซูุงุก ุงูุชุดุบูู:
1. ูู 24 ุณุงุนุฉ โ ูุญุต Config Server
2. ุนูุฏ ูุดู API call โ ูุญุงููุฉ ุฌูุจ config ุฌุฏูุฏ
3. ุนูุฏ ูุดู ูุชูุฑุฑ โ ุนุฑุถ ุฑุณุงูุฉ ูููุณุชุฎุฏู

---

## ๐ ุขููุฉ ุงูุชุญุฏูุซ ุงูุชููุงุฆู

### Scenario 1: ุชุบููุฑ ุงูุฎุงุฏู

```
1. Admin ูุบูุฑ Base URL ูู Config Server
   โ
2. ุงููุณุชุฎุฏู ููุชุญ ุงูุชุทุจูู
   โ
3. ุงูุชุทุจูู ููุญุต Config Server
   โ
4. ูุญุตู ุนูู Base URL ุงูุฌุฏูุฏ
   โ
5. ูุญูุธู ูุญููุงู
   โ
6. ูุนูุฏ ุชููุฆุฉ Dio
   โ
7. ูุณุชูุฑ ุงูุนูู ุจุฏูู ูุดุงูู
```

### Scenario 2: ูุดู Config Server

```
1. Config Server ุบูุฑ ูุชุงุญ
   โ
2. ุงูุชุทุจูู ูุณุชุฎุฏู Base URL ุงููุญููุธ ูุญููุงู
   โ
3. ุฅุฐุง ูุดู โ ูุณุชุฎุฏู Fallback
   โ
4. ูุนุฑุถ ุฑุณุงูุฉ ูููุณุชุฎุฏู (ุงุฎุชูุงุฑู)
```

### Scenario 3: ุชุบููุฑ ูุฏูู (ููุทูุงุฑุฆ)

```
1. ุงููุณุชุฎุฏู ููุชุญ Settings
   โ
2. ูุฏุฎู Base URL ุงูุฌุฏูุฏ
   โ
3. ุงูุชุทุจูู ูุญูุธู
   โ
4. ูุนูุฏ ุชููุฆุฉ Dio
   โ
5. ูุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
```

---

## ๐ก๏ธ ุงูุฃูุงู ูุงูููุซูููุฉ

### 1. ุงูุชุญูู ูู Base URL
- โ ุงูุชุญูู ูู ุตุญุฉ URL format
- โ ุงูุชุญูู ูู HTTPS
- โ ุงูุชุญูู ูู SSL certificate

### 2. Fallback Mechanism
- โ Config Server โ Saved URL โ Fallback URL
- โ Health check ูุจู ุงูุงุณุชุฎุฏุงู

### 3. Cache Strategy
- โ Cache ูุญูู ููู config
- โ TTL ููู cache (24 ุณุงุนุฉ)
- โ Force refresh ุนูุฏ ุงูุญุงุฌุฉ

### 4. Error Handling
- โ Retry mechanism
- โ Exponential backoff
- โ User notification

---

## ๐ ููุงุฑูุฉ ุงูุญููู

| ุงูุญู | ุณูููุฉ ุงูุชูููุฐ | ุงููุฑููุฉ | ุงูุฃูุงู | ุงูุชูุตูุฉ |
|------|---------------|---------|--------|---------|
| Remote Config | โญโญโญโญ | โญโญโญโญโญ | โญโญโญโญ | โ ุงูุฃูุถู |
| Deep Linking | โญโญโญโญโญ | โญโญโญโญ | โญโญโญ | โ ุฌูุฏ |
| Manual Input | โญโญโญโญโญ | โญโญโญโญโญ | โญโญโญ | โ ููุทูุงุฑุฆ |
| Config File | โญโญโญโญ | โญโญโญโญ | โญโญโญ | โ ุฌูุฏ |
| DNS Discovery | โญโญโญ | โญโญโญ | โญโญโญโญ | โ๏ธ ูุนูุฏ |
| Env Variables | โญโญโญ | โญโญ | โญโญโญโญโญ | โ ุบูุฑ ูุฑู |

---

## ๐ฏ ุงูุฎุทุฉ ุงูููุงุฆูุฉ ุงูููุตู ุจูุง

### ุงููุฑุญูุฉ 1: Remote Configuration Server
1. ุฅูุดุงุก ุฎุงุฏู ุฅุนุฏุงุฏุงุช ุจุณูุท
2. API endpoint: `GET /api/config`
3. Response: `{ "baseUrl": "...", "lastUpdated": "..." }`

### ุงููุฑุญูุฉ 2: Configuration Service ูู ุงูุชุทุจูู
1. Service ูุฌูุจ Config
2. ุญูุธ ูู SecureStorage
3. ุงุณุชุฎุฏุงู ูู Dio initialization

### ุงููุฑุญูุฉ 3: Deep Linking (ุงุฎุชูุงุฑู)
1. ุฏุนู deep link ูุชุบููุฑ Base URL
2. QR code scanner

### ุงููุฑุญูุฉ 4: Manual Input (ููุทูุงุฑุฆ)
1. ุตูุญุฉ Settings
2. ุฅุฏุฎุงู Base URL ูุฏููุงู

### ุงููุฑุญูุฉ 5: Health Check
1. ูุญุต ุงูุงุชุตุงู ูุจู ุงูุงุณุชุฎุฏุงู
2. Fallback mechanism

---

## ๐ ููุงุญุธุงุช ุงูุชูููุฐ

### Config Server Requirements:
- ูุฌุจ ุฃู ูููู URL ุซุงุจุช ูุง ูุชุบูุฑ ุฃุจุฏุงู
- ูุฌุจ ุฃู ูููู ูุชุงุญ ุฏุงุฆูุงู (99.9% uptime)
- ูุฌุจ ุฃู ูุฏุนู CORS
- ูุฌุจ ุฃู ูููู ุณุฑูุน (< 500ms)

### Security Considerations:
- โ ุงุณุชุฎุฏุงู HTTPS ููุท
- โ ุงูุชุญูู ูู SSL certificate
- โ Rate limiting ุนูู Config Server
- โ Authentication ููู Config Server (ุงุฎุชูุงุฑู)

### Performance:
- โ Cache ูุญูู ููู config
- โ Background refresh
- โ Lazy loading

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุนูุฏ ุงูุชูููุฐ)

1. **ุฅูุดุงุก Config Server**
   - Node.js/Express ุจุณูุท
   - Endpoint: `GET /api/config`
   - Database/File ููู config

2. **ุชุญุฏูุซ Flutter App**
   - ConfigurationService
   - Update ApiEndpoints
   - Update InjectionContainer

3. **ุฅุถุงูุฉ Deep Linking**
   - URL scheme handler
   - QR code scanner

4. **ุฅุถุงูุฉ Settings Page**
   - Manual Base URL input
   - Config refresh button

5. **Testing**
   - Test config change
   - Test fallback
   - Test deep linking

---

## โ ุงูุฎูุงุตุฉ

**ุงูุญู ุงูููุตู ุจู: Remote Configuration Server + Fallback**

- โ ูุง ูุญุชุงุฌ ุชุนุฏูู ุงูููุฏ ุนูุฏ ุชุบููุฑ ุงูุฎุงุฏู
- โ ุชุญุฏูุซ ููุฑู ูุฌููุน ุงููุณุชุฎุฏููู
- โ Fallback mechanism ููุฃูุงู
- โ Deep linking ููุทูุงุฑุฆ
- โ Manual input ููุงุฎุชุจุงุฑ

**ุงูุชูููุฉ**: ููุฎูุถุฉ (ุฎุงุฏู ุจุณูุท)
**ุงูุชุนููุฏ**: ูุชูุณุท
**ุงููุงุฆุฏุฉ**: ุนุงููุฉ ุฌุฏุงู
